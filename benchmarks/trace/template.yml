benchmark:
  name: Trace
  description: Test which starts a baseline, a victim and multiple neighbors
  max_t: 60
  log_level: info
  scheduler:
    implementation: default
    rdt: false
    log_level: info
  data:
    db:
      host: ${INFLUXDB_HOST}
      name: ${INFLUXDB_BUCKET}
      user: ${INFLUXDB_USER}
      password: ${INFLUXDB_TOKEN}
      org: ${INFLUXDB_ORG}
  docker:
    registry:
      host: ${DOCKER_REGISTRY_HOST}
      username: ${DOCKER_REGISTRY_USERNAME}
      password: ${DOCKER_REGISTRY_PASSWORD}

baseline:
  image: nginx:alpine
  #core: 0
  command: "while :; do dd if=/dev/zero of=/dev/null bs=1M count=100 2>/dev/null; done"
  num_cores: 4
  data:
    frequency: 100
    perf: true
    docker: true
    rdt: true

victim:
  image: registry.jakob-eberhardt.de/neighbor:default  
  # core: 1
  start_t: 20
  expected_t: 15
  command: "/neighbor --duration 15 --buffer-size 12MB --pattern random"
  data:
    frequency: 100
    perf: true
    docker: true
    rdt: true

first:
  image: registry.jakob-eberhardt.de/neighbor:default  
  # core: 2
  start_t: 30
  expected_t: 10
  command: "sleep 5"
  #command: "/neighbor --duration 25 --buffer-size 12MB --pattern random"
  data:
    frequency: 100
    perf: true
    docker: true
    rdt: true

second:
  image: registry.jakob-eberhardt.de/rdt4nn/stress-ng
  # core: 3
  start_t: 35
  expected_t: 10
  command: "stress-ng --matrix-3d 1 --timeout 15"
  data:
    frequency: 100
    perf: true
    docker: true
    rdt: true

matrix:
  image: registry.jakob-eberhardt.de/rdt4nn/stress-ng
  # core: 4
  start_t: 20
  expected_t: 28
  command: "stress-ng --matrix-3d 1 --matrix-3d-ops 20000"
  data:
    frequency: 100
    perf: true
    docker: true
    rdt: true

hadoop:
  image: registry.jakob-eberhardt.de/rdt4nn/hadoop:latest
  port: 9870:9870
  # core: 5
  privileged: true
  expected_t: 48
  environment:
    BENCHMARK_TYPE: wordcount
    DATA_SIZE: 1GB
    MAPS_COUNT: 1
    ITERATIONS: 0
    WARMUP_TIME: 5
  data:
    frequency: 100
    perf: true
    docker: true
    rdt: true